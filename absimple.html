<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Lifting Program — A/B (Embedded Clips)</title>
<style>
  :root {
    --bg: #0f1216;
    --panel: #141922;
    --panel-2: #181e28;
    --text: #e7ecf2;
    --muted: #a8b3c7;
    --accent: #5aa2ff;
    --border: #223045;
    --chip: #0c1422;
    --shadow: 0 6px 20px rgba(0,0,0,.35);
    --radius: 14px;
  }
  * { box-sizing: border-box }
  html, body { height: 100% }
  body {
    margin: 0;
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    background: radial-gradient(1200px 800px at 70% -10%, #152235 0%, var(--bg) 55%);
    color: var(--text);
    line-height: 1.45;
  }
  .wrap { max-width: 1100px; margin: 36px auto; padding: 0 16px }
  .title { font-size: clamp(20px, 2vw + 12px, 28px); font-weight: 800; letter-spacing:.2px; margin: 0 0 24px }

  #schedule-container { margin-bottom: 24px; max-width: 520px; }
  #today-schedule { display: flex; justify-content: flex-start; margin-bottom: 8px; }
  #other-days-schedule { display: grid; grid-template-columns: repeat(6, 1fr); gap: 6px; }
  .day-item {
    background: var(--panel-2);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 6px 5px;
    text-align: center;
    cursor: pointer;
    position: relative;
    transition: all 0.2s ease-in-out;
  }
  .day-item:hover { border-color: #385685; }
  .day-item .day-name {
    font-weight: 600; display: block; font-size: 11px; color: var(--muted);
    margin-bottom: 2px; text-transform: uppercase;
  }
  .day-item .day-prog { font-weight: 600; font-size: 12px; color: var(--accent); }
  .day-item.is-active {
    padding: 10px 24px; border-radius: 10px;
    background: linear-gradient(180deg, #173256, #12233b);
    border-color: #2b4670; box-shadow: inset 0 1px 0 rgba(255,255,255,.06); min-width: 180px;
  }
  .day-item.is-active .day-name { font-size: 14px; color: var(--text); font-weight: 700; text-transform: none; }
  .day-item.is-active .day-prog { font-size: 16px; font-weight: 700; }
  .day-item.is-today::before {
    content: ''; position: absolute; top: 5px; right: 5px; width: 5px; height: 5px;
    border-radius: 99px; background-color: var(--accent); box-shadow: 0 0 4px var(--accent);
  }
  .day-item.is-active.is-today::before { top: 8px; right: 8px; }

  .tabs { display: flex; gap: 8px; margin-top: 24px; justify-content: flex-start; flex-wrap: wrap; max-width: 520px; }
  .tab-btn {
    background: var(--chip); border: 1px solid var(--border); color: var(--text);
    padding: 6px 12px; border-radius: 999px; font-size: 14px; cursor: pointer;
  }
  .tab-btn[aria-pressed="true"] {
    background: linear-gradient(180deg, #173256, #12233b);
    border-color: #2b4670; box-shadow: inset 0 1px 0 rgba(255,255,255,.06);
  }

  .sections { display: grid; gap: 16px; margin-top: 18px; }
  @media (min-width: 900px) { .sections { grid-template-columns: repeat(3, 1fr) } }

  .card {
    background: linear-gradient(180deg, var(--panel), var(--panel-2));
    border: 1px solid var(--border);
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    overflow: hidden;
  }
  .card-hd { padding: 14px 16px; font-weight: 700; font-size: 15px; border-bottom: 1px solid var(--border); }
  .card .rest-image { width: 100%; height: 100%; object-fit: cover; display: block; }

  .list { display: grid }
  .row {
    display: grid; grid-template-columns: 1fr minmax(84px, auto) 36px;
    align-items: center; gap: 10px; padding: 12px 14px; border-top: 1px solid var(--border);
  }
  .row:first-child { border-top: 0 }

  .idx {
    width: 26px; height: 26px; display: grid; place-items: center;
    border: 1px solid var(--border); border-radius: 8px; color: var(--muted);
    font-size: 13px; background: #0c1420; flex: none;
  }
  .name { display: flex; gap: 10px; align-items: center; min-width: 0 }
  .label { font-weight: 600; font-size: 15px; overflow: hidden; text-overflow: ellipsis; word-break: keep-all; }
  .sets { text-align: right; white-space: nowrap; font-feature-settings: "tnum" 1, "ss01" 1; padding-left: 8px; }

  .play { width: 32px; height: 32px; display: grid; place-items: center; border-radius: 10px; border: 1px solid var(--border); background: #0c1420; cursor: pointer; }
  .play svg { width: 16px; height: 16px; fill: var(--text); opacity: .9 }
  .play:hover { outline: 2px solid #2b46704f }

  dialog {
    border: 0; padding: 0; border-radius: 16px; width: min(900px, 92vw);
    background: #0b111b; color: var(--text); box-shadow: 0 30px 70px rgba(0,0,0,.6); overflow: hidden;
  }
  dialog::backdrop { background: rgba(9,14,22,.6) }
  .modal-hd { display: flex; justify-content: space-between; align-items: center; padding: 10px 12px; border-bottom: 1px solid var(--border); background:#0f1726; }
  .modal-hd b { font-size: 14px }
  .close { border: 1px solid var(--border); background: #0c1420; color: var(--text); border-radius: 8px; padding: 6px 10px; cursor: pointer; font-size: 13px; }
  .frame-wrap { aspect-ratio: 16 / 9; background: #000 }
  .frame-wrap iframe { width: 100%; height: 100%; border: 0; display: block }
  .scrim { position: fixed; inset: 0; background: rgba(9,14,22,.6) }
  .sr { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,0,0); white-space: nowrap; border: 0 }
</style>
</head>
<body>
  <div class="wrap">
    <h1 class="title">Lifting Program — Simple A/B</h1>

    <div id="schedule-container">
      <div id="today-schedule"></div>
      <div id="other-days-schedule"></div>
    </div>

    <div id="sections" class="sections" aria-live="polite"></div>

    <div class="tabs" role="tablist" aria-label="Sections">
      <button class="tab-btn" data-filter="all">All</button>
      <button class="tab-btn" data-filter="A">A</button>
      <button class="tab-btn" data-filter="B">B</button>
      <button class="tab-btn" data-filter="Rest">Rest</button>
    </div>
  </div>

  <div id="backdrop" class="scrim" hidden></div>
  <dialog id="player">
    <div class="modal-hd">
      <b id="videoTitle">Video</b>
      <button class="close" id="closeBtn" type="button">Close</button>
    </div>
    <div class="frame-wrap">
      <iframe id="videoFrame" title="Exercise video"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
        allowfullscreen></iframe>
    </div>
  </dialog>

<script>
/* A/B schedule with two-week rotation:
   Week 1 (Mon→Sun): A B Rest A B A Rest  —— “ABRABAR”
   Week 2 (Mon→Sun): B A Rest B A B Rest  —— “BARBABR”
   Tabs and cards follow the same UI as your previous file.
*/

const NBSP  = "\u00A0";
const NNBSP = "\u202F";
const WEEK_DAYS      = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
const WEEK_DAYS_FULL = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];

const WEEK1 = ['A','B','Rest','A','B','A','Rest']; // ABRABAR
const WEEK2 = ['B','A','Rest','B','A','B','Rest']; // BARBABR

const REST_IMAGES = [
  "https://images.pexels.com/photos/371633/pexels-photo-371633.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=750&w=1260",
  "https://images.pexels.com/photos/1034584/pexels-photo-1034584.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=750&w=1260",
  "https://images.pexels.com/photos/691668/pexels-photo-691668.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=750&w=1260",
  "https://images.pexels.com/photos/1761279/pexels-photo-1761279.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=750&w=1260",
  "https://images.pexels.com/photos/189349/pexels-photo-189349.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=750&w=1260"
];

/* Exercises: put YouTube EMBED URLs in `video`. Short, direct clips. */
const PROGRAM = [
  {
    key: "A",
    title: "A — Push + Quads",
    items: [
      { name: "Barbell Bench Press",      sets: "3×5–8",        video: "https://www.youtube.com/embed/sIjdDfwsxUw?start=15&end=45" },
      { name: "Incline Dumbbell Press",   sets: "2×8–12",       video: "https://www.youtube.com/embed/J_UbiifeU8I?start=5&end=30" },
      { name: "Leg Press (Machine)",      sets: "3×8–12",       video: "https://www.youtube.com/embed/fM2WvgirlLM?start=5&end=30" },
      { name: "Bulgarian Split Squat",    sets: "2×8–12/leg",   video: "https://www.youtube.com/embed/2C-uNgKwPLE?start=10&end=55" },
      { name: "Cable Lateral Raise",      sets: "2×12–15",      video: "https://www.youtube.com/embed/v_cT9G-5y_A?start=15&end=45" },
      // Optional finisher if under 45 min:
      // { name: "Triceps Pressdown",        sets: "2×10–15",      video: "https://www.youtube.com/embed/2-LAMcpzODU?start=15&end=45" },
    ],
  },
  {
    key: "B",
    title: "B — Pull + Hinge + Hams",
    items: [
      { name: "Romanian Deadlift",            sets: "3×6–10",       video: "https://www.youtube.com/embed/08StUopZee8?start=10&end=40" },
      { name: "Seated Cable Row",             sets: "3×8–12",       video: "https://www.youtube.com/embed/uZ0r6iYcLwo?start=5&end=30" },
      { name: "Lat Pulldown",                 sets: "3×8–12",       video: "https://www.youtube.com/embed/AtcrCtnah98?start=10&end=40" },
      { name: "Seated or Lying Leg Curl",     sets: "3×10–15",      video: "https://www.youtube.com/embed/1Tq3QdYUuHs?start=10&end=45" },
      { name: "Cable Face Pull",              sets: "2×12–15",      video: "https://www.youtube.com/embed/CruifQcSALU?start=5&end=25" },
      // Optional core if under 45 min:
      // { name: "Hanging Knee Raise",          sets: "2×10–15",      video: "https://www.youtube.com/embed/u3dRrxytkBo?start=5&end=35" },
    ],
  },
];

const $sections = document.getElementById("sections");
const $player = document.getElementById("player");
const $frame  = document.getElementById("videoFrame");
const $title  = document.getElementById("videoTitle");
const $backdrop = document.getElementById("backdrop");
const $close = document.getElementById("closeBtn");
const $scheduleContainer = document.getElementById('schedule-container');

let viewedDayIndex;
const today = new Date();
const todayIndex = today.getDay();

function getISOWeek(d) {
  const date = new Date(Date.UTC(d.getFullYear(), d.getMonth(), d.getDate()));
  const dayNum = (date.getUTCDay() + 6) % 7;
  date.setUTCDate(date.getUTCDate() - dayNum + 3);
  const firstThursday = new Date(Date.UTC(date.getUTCFullYear(),0,4));
  const firstThursdayDay = (firstThursday.getUTCDay() + 6) % 7;
  firstThursday.setUTCDate(firstThursday.getUTCDate() - firstThursdayDay + 3);
  const week = 1 + Math.round((date - firstThursday) / (7 * 24 * 3600 * 1000));
  return week;
}
function getWeekPattern(d) {
  // Odd ISO week -> WEEK1 (ABRABAR). Even ISO week -> WEEK2 (BARBABR).
  const isoWeek = getISOWeek(d);
  return (isoWeek % 2 === 1) ? WEEK1 : WEEK2;
}

function h(tag, attrs = {}, ...kids) {
  const el = document.createElement(tag);
  for (const [k, v] of Object.entries(attrs)) {
    if (k === "class") el.className = v;
    else if (k.startsWith("on")) el.addEventListener(k.slice(2).toLowerCase(), v);
    else if (v != null) el.setAttribute(k, v);
  }
  for (const kid of kids.flat()) {
    if (kid == null) continue;
    el.appendChild(typeof kid === "string" ? document.createTextNode(kid) : kid);
  }
  return el;
}

function render(filter = "all") {
  $sections.innerHTML = "";
  if (filter === 'Rest') {
    const i = Math.floor(Math.random() * REST_IMAGES.length);
    $sections.innerHTML = `<div class="card" style="grid-column: 1 / -1; padding: 0;"><img src="${REST_IMAGES[i]}" class="rest-image" alt="A relaxing image for a rest day."></div>`;
    return;
  }
  const groups = PROGRAM.filter(s => filter === "all" || s.key === filter);
  for (const group of groups) {
    const card = h("section", { class: "card", "data-section": group.key });
    card.appendChild(h("div", { class: "card-hd" }, `${group.title}`));
    const list = h("div", { class: "list", role: "list" },
      group.items.map((it, i) =>
        h("div", { class: "row", role: "listitem" },
          h("div", { class: "name" },
            h("div", { class: "idx", "aria-hidden": "true" }, String(i+1)),
            h("div", {},
              h("div", { class: "label" }, it.name),
              h("div", { class: "sr" }, `${group.key} · Exercise ${i+1}`)
            )
          ),
          h("div", { class: "sets" }, it.sets),
          h("button", {
            class: "play", type: "button", title: "Play clip",
            onClick: () => openVideo(it),
            "aria-label": `Play video for ${it.name}`,
          }, svgPlay())
        )
      )
    );
    card.appendChild(list);
    $sections.appendChild(card);
  }
}

function renderSchedule(activeDayIndex) {
  const SCHEDULE_KEYS = getWeekPattern(new Date());
  const $todayContainer = document.getElementById('today-schedule');
  const $otherContainer = document.getElementById('other-days-schedule');
  $todayContainer.innerHTML = '';
  $otherContainer.innerHTML = '';

  const orderedDays = [1, 2, 3, 4, 5, 6, 0]; // Mon -> Sun

  for (const dayIndex of orderedDays) {
    const isActive = dayIndex === activeDayIndex;
    const item = h('div', { class: 'day-item', 'data-day-index': dayIndex });

    if (dayIndex === todayIndex) item.classList.add('is-today');

    const dayNameString = isActive ? WEEK_DAYS_FULL[dayIndex] : WEEK_DAYS[dayIndex];
    const dayName = h('span', { class: 'day-name' }, dayNameString);
    const progName = h('span', { class: 'day-prog' }, SCHEDULE_KEYS[dayIndex]);
    item.append(dayName, progName);

    if (isActive) {
      item.classList.add('is-active');
      $todayContainer.appendChild(item);
    } else {
      $otherContainer.appendChild(item);
    }
  }
}

function updateViewForDay(dayIndex) {
  const schedule = getWeekPattern(new Date());
  viewedDayIndex = dayIndex;
  const programKey = schedule[viewedDayIndex];

  renderSchedule(viewedDayIndex);
  render(programKey);

  document.querySelectorAll(".tab-btn").forEach(b => b.setAttribute("aria-pressed", "false"));
  const activeTab = document.querySelector(`.tab-btn[data-filter="${programKey}"]`);
  if (activeTab) {
    activeTab.setAttribute("aria-pressed", "true");
  } else {
    document.querySelector('.tab-btn[data-filter="all"]').setAttribute("aria-pressed", "true");
  }
}

function svgPlay() {
  const el = document.createElementNS("http://www.w3.org/2000/svg","svg");
  el.setAttribute("viewBox","0 0 24 24");
  el.innerHTML = '<path d="M8 5.14v13.72a1 1 0 0 0 1.52.86l10.02-6.86a1 1 0 0 0 0-1.72L9.52 4.28A1 1 0 0 0 8 5.14zM4 6a2 2 0 0 1 2-2h1v2H6v12h1v2H6a2 2 0 0 1-2-2V6z"/>';
  return el;
}

function openVideo(item) {
  if (!item.video) { alert("No video set for this exercise."); return; }
  $title.textContent = item.name;
  $frame.src = item.video + (item.video.includes("?") ? "&" : "?") + "autoplay=1&rel=0&modestbranding=1";
  $backdrop.hidden = false;
  $player.showModal?.();
}
function closeVideo() {
  $frame.src = "";
  $player.close?.();
}

$player.addEventListener('close', () => { $frame.src = ""; $backdrop.hidden = true; });
$close.addEventListener("click", closeVideo);
$player.addEventListener("click", (event) => { if (event.target === $player) closeVideo(); });

document.querySelectorAll(".tab-btn").forEach(btn => {
  btn.addEventListener("click", () => {
    const filter = btn.dataset.filter;
    viewedDayIndex = todayIndex;
    renderSchedule(viewedDayIndex);
    render(filter);
    document.querySelectorAll(".tab-btn").forEach(b => b.setAttribute("aria-pressed", "false"));
    btn.setAttribute("aria-pressed", "true");
  });
});

document.getElementById('schedule-container').addEventListener('click', (e) => {
  const dayItem = e.target.closest('.day-item');
  if (dayItem && dayItem.dataset.dayIndex) {
    updateViewForDay(parseInt(dayItem.dataset.dayIndex));
  }
});

// --- Initial Page Load ---
updateViewForDay(todayIndex);
</script>
</body>
</html>
